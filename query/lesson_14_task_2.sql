SELECT STRING_AGG(S.[Фамилия], ', ') AS [Фамилии студентов]
FROM dbo.[Студенты] S
JOIN dbo.[Направления] N ON S.[Код направления] = N.[Код направления]
WHERE N.[Наименование] = N'История'
  AND S.[Экзаменационный балл] >= N.[Минимальный балл];
